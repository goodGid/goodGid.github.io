---
layout: post
title:  " 멀티 쓰레드(Multi Thread)란 무엇인가? "
categories: OS
tags: OS
author: goodGid
---
* content
{:toc}

## 멀티 쓰레드(Thread)란 무엇인가?

* 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유하고 <br> 자원의 생성과 관리의 중복성을 최소화하여 <br> 수행 능력을 향상시키는 것을 **멀티쓰레딩**이라고 한다.

* 하나의 프로그램에 동시에 여러개의 일을 수행할수 있도록 해주는 것이다.










---


## 멀티 쓰레드를 사용하는 이유는?

* 프로세스를 이용하여 동시에 처리하던 일을 쓰레드로 구현할 경우 <br>  메모리 공간과 시스템 자원 소모가 줄어들게 된다. 

* 쓰레드 간의 통신이 필요한 경우에도 별도의 자원을 이용하는 것이 아니라 <br> **전역 변수의 공간** 또는 동적으로 할당된 공간인 **힙(Heap) 영역**을 이용하여 데이터를 주고받을 수 있다. 

* 그렇기 때문에 프로세스 간 통신 방법에 비해  <br> 쓰레드 간의 통신 방법이 훨씬 간단하다.

* 심지어 **쓰레드**의 **문맥 교환**은 프로세스 문맥 교환과는 달리  <br> **캐시 메모리를 비울 필요**가 없기 때문에 더 빠르다. 

* 따라서 **시스템의 처리량**이 향상되고  <br> 자원 소모가 줄어들어 자연스럽게 프로그램의 응답 시간이 단축된다. 

* 이러한 장점 때문에 여러 프로세스로 할 수 있는 작업들을 <br> 하나의 프로세스에서 **여러 쓰레드**로 나눠 수행하는 것이다.

---


## 멀티 프로세스와 멀티 쓰레드의 차이점

* 멀티 프로세스 : [데이터 영역, 힙, 스택 ]영역 **모두**를 **비공유**

* 멀티 쓰레드 : [ 데이터 영역, 힙, 스택 ]영역중 **스택 영역만** **비공유**


---

## 멀티 쓰레딩의 장점

* 프로세스 생성은 많은 시간과 자원을 소비한다. 

* 이러한 단점을 최소화 시킨 일종의 **경량화된 프로세스 = 쓰레드**를 만들게 된 것이다.

* 멀티 쓰레드에서 쓰레드간 **스택 영역**만 **비공유**하고 <br> **데이터 영역**과 **힙 영역**을 **공유**한다.

* 쓰레드의 **생성 및 컨텍스트 스위칭**은 <br> 프로세스의 생성 및 컨텍스트 스위칭보다 빠르다.

* 멀티 쓰레드 **컨텍스트 스위칭** 시 **데이터 영역**과 **힙**을 뮤올리고 내릴 필요가 없다.

* **데이터 영역**과 **힙 영역**을 통해 데이터 교환이 가능하다.

* 쓰레드 사이에서의 **데이터 교환**에서는 특별한 기법이 필요없다.


![](/assets/img/os/what_is_multi_thread_1.png)

---

## 멀티 쓰레딩의 문제점

* **멀티 프로세스** 기반으로 프로그래밍할 때는 프로세스 간 공유하는 자원이 없기 때문에 <br> 동일한 자원에 동시에 접근하는 일이 없었지만 <br> **멀티 쓰레딩**을 기반으로 프로그래밍할 때는 이 부분을 신경써줘야 한다. 

* 서로 다른 쓰레드가 **데이터와 힙 영역**을 공유하기 때문에 <br> 어떤 쓰레드가 다른 쓰레드에서 사용중인 변수나 <br> 자료 구조에 접근하여 엉뚱한 값을 읽어오거나 수정할 수 있다.

* 그렇기 때문에 멀티쓰레딩 환경에서는 **동기화 작업**이 필요하다. 

* 동기화를 통해 **작업 처리 순서**를 컨트롤 하고 <br> **공유 자원**에 대한 접근을 컨트롤 하는 것이다. 

* 하지만 이로 인해 **병목 현상**이 발생하여 성능이 저하될 가능성이 높다. 

* 그러므로 과도한 **락(lock)**으로 인한 병목 현상을 줄여야 한다.

* 공유 자원이 아닌 부분은 동기화 처리를 할 필요가 없다. <br> 즉, 동기화 처리가 필요한 부분에만 **synchronized** 키워드를 통해 동기화하는 것이다. 

* 불필요한 부분까지 동기화를 할 경우 <br> 현재 쓰레드는 락(lock)을 획득한 쓰레드가 종료하기 전까지 대기해야한다. <br> 그렇게 되면 전체 성능에 영향을 미치게 된다.

* 즉 동기화를 하고자 할 때는 <br> 메소드 전체를 동기화 할 것인가 아니면 특정 부분만 동기화할 것인지 고민해야 한다.


---

## 참고

* [멀티쓰레딩에 대해서](asfirstalways.tistory.com/340)

* [멀티쓰레드란?](https://m.blog.naver.com/PostView.nhn?blogId=rja1104&logNo=220551216367&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F)